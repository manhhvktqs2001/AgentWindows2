2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO: === EDR Agent Windows Starting ===
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO: Version: 1.0.0
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO: Build Time: 2025-08-06
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO: Config Path: config.yaml
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO: Agent Name: edr-agent-windows-safe
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO: Server URL: http://192.168.20.85:5000
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO: Safe Mode: false
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO: Monitoring Enabled:
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO:   - File System: true
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO:   - Processes: true
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO:   - Network: true
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO:   - Registry: true
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO: YARA Enabled: true
2025/08/11 16:22:01 [2025-08-11 16:22:01] INFO: Loaded 393 YARA rule files:
2025/08/11 16:22:06 [2025-08-11 16:22:06] INFO:    1. antidebug_antivm\antidebug_antivm.yar (27570 bytes)
2025/08/11 16:22:06 [2025-08-11 16:22:06] WARN: YARA rules listing timeout
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO:    2. exploit_kits\EK_Angler.yar (10889 bytes)
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Starting Response Manager...
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Response Manager started successfully
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: ðŸ’» Running in console mode
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Starting EDR Agent...
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO:    3. exploit_kits\EK_Blackhole.yar (14656 bytes)
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: MAC check result - Exists: true
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Agent exists on server, using ID: cb5c1eb3-2bc8-469f-b02f-12cdfcaff1ef
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Agent ID set: cb5c1eb3-2bc8-469f-b02f-12cdfcaff1ef
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO:    4. exploit_kits\EK_BleedingLife.yar (3401 bytes)
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO:    5. exploit_kits\EK_Crimepack.yar (1349 bytes)
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: YARA: external scanner ready (rules: yara-rules)
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Starting file system monitor with safety limits...
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO:    6. exploit_kits\EK_Phoenix.yar (17029 bytes)
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Found 3 valid paths out of 3 configured paths
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Started monitoring directory: C:\Users\Manh\Desktop
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Started monitoring directory: C:\Users\Manh\Downloads
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Started monitoring directory: C:\Users\Manh\Documents
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: File system monitor started successfully - watching 3 directories
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Starting process monitor with safe settings...
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: File monitor event processor started - events will be sent to agent
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Enumerated 78 processes
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Process monitor started successfully
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Starting network monitor...
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Network monitor started successfully
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Starting registry monitor...
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Started monitoring registry key: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Started monitoring registry key: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Started monitoring registry key: HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Registry monitor started successfully
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: EDR Agent started successfully
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: âœ… EDR Agent started successfully
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Press Ctrl+C to stop
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Event worker started - will send events to server every 2s or when batch is full
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO: Monitor event worker started - listening for events from all monitors
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO:    7. exploit_kits\EK_Sakura.yar (2047 bytes)
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO:    8. maldocs\Maldoc_APT19_CVE-2017-0199.yar (4500 bytes)
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO:    9. maldocs\Maldoc_APT_OLE_JSRat.yar (554 bytes)
2025/08/11 16:22:07 [2025-08-11 16:22:07] INFO:    10. maldocs\Maldoc_CVE_2017_8759.yar (3710 bytes)
2025/08/11 16:22:09 [2025-08-11 16:22:09] INFO: Sending batch of 52 events to server (timer)
2025/08/11 16:22:10 [2025-08-11 16:22:10] INFO: Sent 52 events to server
2025/08/11 16:23:19 [2025-08-11 16:23:19] INFO: Sending batch of 6 events to server (timer)
2025/08/11 16:23:19 [2025-08-11 16:23:19] INFO: Sent 6 events to server
2025/08/11 16:23:29 [2025-08-11 16:23:29] INFO: Sending batch of 1 events to server (timer)
2025/08/11 16:23:30 [2025-08-11 16:23:30] INFO: Sent 1 events to server
2025/08/11 16:23:47 [2025-08-11 16:23:47] INFO: Sending batch of 3 events to server (timer)
2025/08/11 16:23:47 [2025-08-11 16:23:47] INFO: Sent 3 events to server
2025/08/11 16:24:07 [2025-08-11 16:24:07] INFO: Sending batch of 100 events to server (batch full)
2025/08/11 16:24:08 [2025-08-11 16:24:08] INFO: Sent 100 events to server
2025/08/11 16:24:09 [2025-08-11 16:24:09] INFO: Sending batch of 3 events to server (timer)
2025/08/11 16:24:09 [2025-08-11 16:24:09] INFO: Sent 3 events to server
2025/08/11 16:24:47 [2025-08-11 16:24:47] INFO: Sending batch of 1 events to server (timer)
2025/08/11 16:24:47 [2025-08-11 16:24:47] INFO: Sent 1 events to server
