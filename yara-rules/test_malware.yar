rule TestMalware {
    meta:
        description = "Test rule to detect malware files"
        author = "EDR System"
        severity = 3
        threat_type = "malware"
    
    strings:
        $malware_string = "This is a test malware file for EDR testing"
        $eicar_string = "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*"
        $suspicious_ext = /\.(exe|com|bat|cmd|scr|pif)$/i
    
    condition:
        any of them
}

rule TestRansomware {
    meta:
        description = "Test rule to detect ransomware patterns"
        author = "EDR System"
        severity = 5
        threat_type = "ransomware"
    
    strings:
        $encrypt_string = "encrypt"
        $ransom_string = "ransom"
        $bitcoin_string = "bitcoin"
        $payment_string = "payment"
    
    condition:
        2 of them
}

rule TestBackdoor {
    meta:
        description = "Test rule to detect backdoor patterns"
        author = "EDR System"
        severity = 4
        threat_type = "backdoor"
    
    strings:
        $backdoor_string = "backdoor"
        $reverse_shell = "reverse shell"
        $cmd_string = "cmd.exe"
        $powershell_string = "powershell"
    
    condition:
        2 of them
}

rule TestTrojan {
    meta:
        description = "Test rule to detect trojan patterns"
        author = "EDR System"
        severity = 4
        threat_type = "trojan"
    
    strings:
        $trojan_string = "trojan"
        $keylogger_string = "keylogger"
        $spyware_string = "spyware"
        $steal_string = "steal"
    
    condition:
        2 of them
} 